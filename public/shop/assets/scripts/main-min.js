function createPopup(t){let e=document.querySelector(t),c=e.querySelector(".overlay"),a=e.querySelector(".close-btn");function r(){e.classList.remove("active")}return c.addEventListener("click",r),a.addEventListener("click",r),function(){e.classList.add("active")}}let popup=createPopup("#popup");document.querySelector("#basket").addEventListener("click",popup);const categoryButtons=document.querySelectorAll(".category-item"),xhttp=new XMLHttpRequest;function getProducts(t,e){xhttp.onreadystatechange=async function(){if(4==this.readyState&&200==this.status){let t="";if(document.getElementById("products").style.opacity="0",document.querySelector(".product-header").style.opacity="0","228"===this.responseText)t=' <h2 style="margin:auto;margin-top:45px;">Kategoriye Ait Ürün Bulunamadı</h2>';else{let e=await JSON.parse(this.responseText);e.forEach((e=>{t+=`\n        <div class="product-item">\n          <img class="product-image"src="${base_url}public/shop/assets/images/${routing_name}/products/${e.product_picture}">\n          <div class="product-info">\n            <h3 class="product-name">${e.product_name}</h3>\n            <p class="product-price">${e.product_price}</p>\n          </div>\n          <button class="btn-add-to-cart" data-product-id="${e.id}"><i class="fa-solid fa-plus"></i></button>\n        </div>\n        `})),setTimeout((()=>{addToCartData(e)}),1e3)}setTimeout((function(){document.querySelector(".product-header").innerHTML=e,document.getElementById("products").innerHTML=t,document.getElementById("products").style.opacity="1",document.querySelector(".product-header").style.opacity="1"}),200)}},xhttp.open("POST",`${base_url}api/shop/product`,!0),xhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded"),xhttp.send(`category_id=${t}`)}categoryButtons.forEach((t=>{t.addEventListener("click",(function(){getProducts(t.getAttribute("data-category-id"),t.getAttribute("data-category-name"))}))})),document.querySelectorAll(".category-item")[0].click();const cartBtn=document.querySelector(".basket"),cartItems=document.querySelector(".basket-count"),cartTotal=document.querySelector(".subtotal-value"),cartContent=document.querySelector(".modal-products");let cart=[];if(null!=localStorage.getItem("cart")){cart=JSON.parse(localStorage.getItem("cart"));let t=0;cart.forEach((e=>{t+=Number(e.amount)})),cartItems.innerHTML=t}function addToCartData(t){[...document.querySelectorAll(".btn-add-to-cart")].forEach((e=>{e.addEventListener("click",(function(){e.disabled=!0;let c=e.getAttribute("data-product-id");t.forEach((t=>{if(t.id==c){const e=cart.findIndex((t=>t.id==c));-1!==e?cart[e].amount+=1:cart.push({...t,amount:1})}})),localStorage.setItem("cart",JSON.stringify(cart)),uiDraw(),setTimeout((()=>{e.disabled=!1}),200)}))}))}function uiDraw(){let t="";cart.forEach((e=>{t+=` \n      <div class="product-item">\n         <img class="product-image" src="${base_url}public/shop/assets/images/${routing_name}/products/${e.product_picture}">\n         <div class="product-info">\n           <h3 class="product-name">${e.product_name}</h3>\n           <p class="product-price">${e.product_price}</p>\n         </div>\n         <div class="product-item-right">\n           <div class="product-item-right-quantity">\n             <button class="quantity-plus" data-product-id="${e.id}">\n               <i class="fa-solid fa-plus"></i>\n             </button>\n             <span class="quantity">${e.amount}</span>\n             <button class="quantity-minus" data-product-id="${e.id}">\n               <i class="fa-solid fa-minus"></i>\n             </button>\n           </div>\n         </div>\n      </div>\n    `})),cartContent.innerHTML=t;let e=0,c=0;cart.forEach((t=>{e+=Number(t.amount),c+=Number(t.product_price)*Number(t.amount)})),cartItems.innerHTML=e,cartTotal.innerHTML=`${c}<span class="tl"> TL</span>`,setTimeout((()=>{productPlus(),productMinus()}),200)}function productPlus(){[...document.querySelectorAll(".quantity-plus")].forEach((t=>{t.addEventListener("click",(function(){let e=t.getAttribute("data-product-id"),c=cart.find((t=>t.id==parseInt(e)));c&&(c.amount+=1),localStorage.setItem("cart",JSON.stringify(cart)),uiDraw()}))}))}function productMinus(){[...document.querySelectorAll(".quantity-minus")].forEach((t=>{t.addEventListener("click",(function(){let e=t.getAttribute("data-product-id"),c=cart.find((t=>t.id==parseInt(e)));c&&(c.amount-=1,c.amount<=0&&(cart=cart.filter((t=>t.id!==c.id)))),localStorage.setItem("cart",JSON.stringify(cart)),uiDraw()}))}))}document.addEventListener("DOMContentLoaded",(()=>{setTimeout((()=>{uiDraw()}),500)}));